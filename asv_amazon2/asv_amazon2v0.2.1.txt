# asv_amazon2 v0.2
# Add Amazon items to your TXP article
# Amit Varia
# http://www.amitvaria.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjQ6Im5hbWUiO3M6MTE6ImFzdl9hbWF6b24yIjtzOjc6InZlcnNpb24iO3M6Mzoi
MC4yIjtzOjY6ImF1dGhvciI7czoxMDoiQW1pdCBWYXJpYSI7czoxMDoiYXV0aG9yX3VyaSI7
czoyNToiaHR0cDovL3d3dy5hbWl0dmFyaWEuY29tLyI7czoxMToiZGVzY3JpcHRpb24iO3M6
MzY6IkFkZCBBbWF6b24gaXRlbXMgdG8geW91ciBUWFAgYXJ0aWNsZSI7czo0OiJ0eXBlIjtp
OjE7czo0OiJoZWxwIjtzOjIxOTQ6Igk8aDE+YXN2X2FtYXpvbjI8L2gxPgoKCTxoMj52ZXJz
aW9uIDAuMjwvaDI+CgoJPGgzPldoYXQmIzgyMTc7cyBuZXc/PC9oMz4KCgk8cD5BIGxvbmcg
dGltZSBhZ28sIEkgY3JlYXRlZCBhIHBsdWdpbiBjYWxsZWQgYXN2X2FtYXpvbiwgd2hpY2gg
bGV0IHlvdSBkaXNwbGF5IHByb2R1Y3RzIGZyb20gQW1hem9uIG9uIHlvdXIgc2l0ZS4gSXQg
d29ya2VkLCBidXQgaW5zZXJ0aW5nIHRoZSBwcm9kdWN0IHJlcXVpcmVkIHlvdSB0byBnbyB0
byBBbWF6b24sIGNvcHkgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5BU0lOPC9zcGFuPiBudW1i
ZXIsIGFuZCBwYXN0ZSBpbnRvIHRoZSBUZXh0UGF0dGVybi4gV2hhdCBhIGhhc3NsZSEgV2Vs
bCBJIGZpbmFsbHkgZ290IGFyb3VuZCB0byB3cml0aW5nIHRoZSBuZXh0IHZlcnNpb24gb2Yg
YXN2X2FtYXpvbi4gSSYjODIxNzt2ZSBjYWxsZWQgaXQgYXN2X2FtYXpvbjIgc2luY2UgaXQg
aXMgY29tcGxldGVseSB3cml0dGVuIGFuZCB3b3JrcyBpbiBhIHdob2xlIG5ldyB3YXkuPC9w
PgoKCTxoMz5Ib3cgZG9lcyBpdCB3b3JrPzwvaDM+CgoJPHA+U2ltcGxlICYjODIxMTsgd2hl
biB3cml0aW5nIGFuIGFydGljbGUganVzdCBjbGljayBvbiB0aGUgJiM4MjIwO0FtYXpvbjIm
IzgyMjE7IGxpbmsgaW4gdGhlIHRvcCByaWdodCBjb2x1bW4uIFlvdSBjYW4gc2VhcmNoIGFu
ZCBhZGQgcHJvZHVjdHMgdG8geW91ciBwb3N0IGJ5IGNsaWNraW5nIHRoZSAmIzgyMjA7YWRk
JiM4MjIxOyBidXR0b24gbmV4dCB0byBlYWNoIGl0ZW0uPC9wPgoKCTxoMz5DcmVhdGluZyBh
IGZvcm08L2gzPgoKCTxwPldpdGggdmVyc2lvbiAwLjIsIHlvdSB3aWxsIGhhdmUgdG8gaGF2
ZSBmb3JtcyB0byBnZW5lcmF0ZSB0aGUgbGF5b3V0IG9mIHRoZSBwcm9kdWN0IG9uIHlvdXIg
cGFnZS4gV2hlbiBjcmVhdGluZyBhIG5ldyAmIzgyMTY7bWlzYyYjODIxNzsgZm9ybSB5b3Ug
Y2FuIHVzZSB0aGUgZm9sbG93aW5nIHZhbHVlczo8L3A+CgoJPHA+YXN2X2FtYXpvbjJfdXJs
PGJyIC8+CmFzdl9hbWF6b24yX3NJbWFnZVVybDxiciAvPgphc3ZfYW1hem9uMl9tSW1hZ2VV
cmw8YnIgLz4KYXN2X2FtYXpvbjJfbEltYWdlVXJsPGJyIC8+CmFzdl9hbWF6b24yX2FzaW48
YnIgLz4KYXN2X2FtYXpvbjJfdGl0bGU8L3A+CgoJPHA+YXN2X2FtYXpvbjIgd2lsbCBqdXN0
IHJlcGxhY2UgdGhlc2UgbGl0ZXJhbHMgd2l0aCB0aGVpciBwcm9kdWN0IGNvdW50ZXJwYXJ0
LCBzbzo8L3A+Cgo8cHJlPjxjb2RlPiYjNjA7YSBocmVmPSYjMzQ7YXN2X2FtYXpvbjJfdXJs
JiMzNDsmIzYyOyYjNjA7aW1nIHNyYz0mIzM0O2Fzdl9hbWF6b24yX3NJbWFnZVVybCYjMzQ7
IC8mIzYyOyYjNjA7YnIgLyYjNjI7YXN2X2FtYXpvbjJfdGl0bGUmIzYwOy9hJiM2MjsKPC9j
b2RlPjwvcHJlPgoKCTxwPnJldHVybnM6PC9wPgoKPHByZT48Y29kZT4mIzYwO2EgaHJlZj0m
IzM0O2h0dHA6Ly93d3cuYW1hem9uLmNvbS9ncC9yZWRpcmVjdC5odG1sJTNGQVNJTj0xNTkw
NTk4MzI2JTI2dGFnPXdzJTI2bGNvZGU9eG0yJTI2Y0lEPTIwMjUlMjZjY21JRD0xNjU5NTMl
MjZsb2NhdGlvbj0vby9BU0lOLzE1OTA1OTgzMjYlMjUzRlN1YnNjcmlwdGlvbklkPTBZOEYx
WVYxTjJZU0dKMU1DMjAyJiMzNDsmIzYyOyYjNjA7aW1nIHNyYz0mIzM0O2h0dHA6Ly9lYzEu
aW1hZ2VzLWFtYXpvbi5jb20vaW1hZ2VzL0kvMDF5YXExZXRqS0wuanBnJiMzNDsgLyYjNjI7
JiM2MDticiAvJiM2MjtUZXh0cGF0dGVybiBTb2x1dGlvbnM6IFBIUC1CYXNlZCBDb250ZW50
IE1hbmFnZW1lbnQgTWFkZSBFYXN5IChTb2x1dGlvbnMpJiM2MDsvYSYjNjI7CndoaWNoIHdp
bGwgZGlzcGxheSBsaWtlIHRoaXM6CjwvY29kZT48L3ByZT4KCgk8cD48YSBocmVmPSJodHRw
Oi8vd3d3LmFtYXpvbi5jb20vZ3AvcmVkaXJlY3QuaHRtbCUzRkFTSU49MTU5MDU5ODMyNiUy
NnRhZz13cyUyNmxjb2RlPXhtMiUyNmNJRD0yMDI1JTI2Y2NtSUQ9MTY1OTUzJTI2bG9jYXRp
b249L28vQVNJTi8xNTkwNTk4MzI2JTI1M0ZTdWJzY3JpcHRpb25JZD0wWThGMVlWMU4yWVNH
SjFNQzIwMiI+PGltZyBzcmM9Imh0dHA6Ly9lYzEuaW1hZ2VzLWFtYXpvbi5jb20vaW1hZ2Vz
L0kvMDF5YXExZXRqS0wuanBnIiAvPjxiciAvPgpUZXh0cGF0dGVybiBTb2x1dGlvbnM6IFBI
UC1CYXNlZCBDb250ZW50IE1hbmFnZW1lbnQgTWFkZSBFYXN5IChTb2x1dGlvbnMpPC9hPjwv
cD4iO3M6NDoiY29kZSI7czoxMjA0ODoiLy8gYXN2X2FtYXpvbjIKLy8gRGVzaWduZWQgYXJv
dW5kIHRoZSBuZWVkIHRvIGluY2x1ZGUgaXRlbXMgZnJvbSBBbWF6b24gaW4geW91ciB3ZWJz
aXRlCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQoKaWYoJ2FkbWluJyA9PSBAdHhwaW50ZXJmYWNlKQp7CglyZWdpc3Rl
cl9jYWxsYmFjaygnYXN2X2FtYXpvbjInLCAnYXJ0aWNsZScpOwp9CgovLy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmlm
KGdwcygnYXN2X2FtYXpvbjJfYWN0aW9uJykgJiYgZ3BzKCdhc3Zfa2V5d29yZHMnKSkKewoJ
JGFzdl9hbWF6b24gPSBuZXcgYXN2X0FtYXpvbigiVVMiKTsKCWhlYWRlcignQ29udGVudC1U
eXBlOiB0ZXh0L3htbCcpOwoJZWNobyAkYXN2X2FtYXpvbi0+cmVxdWVzdChncHMoJ2Fzdl9r
ZXl3b3JkcycpLCBncHMoJ2Fzdl9zZWFyY2hpbmRleCcpLCBncHMoJ2Fzdl9pdGVtcGFnZScp
KTsKCWV4aXQ7Cn0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKaWYoZ3BzKCdhc3ZfYW1hem9uMl9mb3JtX2FjdGlv
bicpKQp7CgkkZm9ybSA9IGdwcygnYXN2X2FtYXpvbjJfZm9ybScpOwoKCSRhc3ZfYW1hem9u
Ml9jb250ZW50cyA9IGFycmF5KCk7CgkkYXN2X2FtYXpvbjJfY29udGVudHNbJ2Fzdl9hbWF6
b24yX3VybCddID0gZ3BzKCdhc3ZfYW1hem9uMl91cmwnKTsKCSRhc3ZfYW1hem9uMl9jb250
ZW50c1snYXN2X2FtYXpvbjJfc0ltYWdlVXJsJ10gPSBncHMoJ2Fzdl9hbWF6b24yX3NJbWFn
ZVVSTCcpOwoJJGFzdl9hbWF6b24yX2NvbnRlbnRzWydhc3ZfYW1hem9uMl9tSW1hZ2VVcmwn
XSA9IGdwcygnYXN2X2FtYXpvbjJfbUltYWdlVVJMJyk7CgkkYXN2X2FtYXpvbjJfY29udGVu
dHNbJ2Fzdl9hbWF6b24yX2xJbWFnZVVybCddID0gZ3BzKCdhc3ZfYW1hem9uMl9sSW1hZ2VV
UkwnKTsKCSRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpvbjJfYXNpbiddID0gZ3Bz
KCdhc3ZfYW1hem9uMl91cmwnKTsKCSRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpv
bjJfdGl0bGUnXSA9IGdwcygnYXN2X2FtYXpvbjJfdGl0bGUnKTsKCglpZigkZm9ybSkKCXsK
CQkkYXN2X2FtYXpvbjJfZm9ybSA9IGZldGNoX2Zvcm0oJGZvcm0pOwoJCWZvcmVhY2goJGFz
dl9hbWF6b24yX2NvbnRlbnRzIGFzICRrZXk9PiR2YWx1ZSkKCQl7CgkJCSRhc3ZfYW1hem9u
Ml9mb3JtID0gc3RyX3JlcGxhY2UoJGtleSwgJHZhbHVlLCAJJGFzdl9hbWF6b24yX2Zvcm0p
OwoJCX0KCX0KCWVsc2UKCXsKCQkkYXN2X2FtYXpvbjJfZm9ybSA9ICI8YSBocmVmPVwiIi4k
YXN2X2FtYXpvbjJfY29udGVudHNbJ2Fzdl9hbWF6b24yX3VybCddLiJcIj48aW1nIHNyYz1c
IiIuJGFzdl9hbWF6b24yX2NvbnRlbnRzWydhc3ZfYW1hem9uMl9zSW1hZ2VVcmwnXS4iXCIg
Lz48YnIgLz4iLiRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpvbjJfdGl0bGUnXS4i
PC9hPjxiciAvPiI7Cgl9CgoJZWNobygkYXN2X2FtYXpvbjJfZm9ybSk7CgoJZXhpdDsKfQoK
Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCgpmdW5jdGlvbiBhc3ZfYW1hem9uMiAoJGV2ZW50LCAkc3RlcCkKewoJJGFz
dl9zZWFyY2hJbmRleCA9IGFycmF5KCJBcHBhcmVsIiwgIkJhYnkiLCAiQmxlbmRlZCIsICJC
b29rcyIsICJDbGFzc2ljYWwiLCAiRFZEIiwgIkRpZ2l0YWxNdXNpYyIsICJFbGVjdHJvbmlj
cyIsICJHb3VybWV0Rm9vZCIsICJIZWFsdGhQZXJzb25hbENhcmUiLCAiSmV3ZWxyeSIsICJL
aXRjaGVuIiwgIk1hZ2F6aW5lcyIsICJNZXJjaGFudHMiLCAiTWlzY2VsbGFuZW91cyIsICJN
dXNpYyIsICJNdXNpY1RyYWNrcyIsICJNdXNpY2FsSW5zdHJ1bWVudHMiLCAiT2ZmaWNlUHJv
ZHVjdHMiLCAiT3V0ZG9vckxpdmluZyIsICJQQ0hhcmR3YXJlIiwgIlBldFN1cHBsaWVzIiwg
IlBob3RvIiwgIlJlc3RhdXJhbnRzIiwgIlNvZnR3YXJlIiwgIlNwb3J0aW5nR29vZHMiLCAi
VG9vbHMiLCAiVG95cyIsICJWSFMiLCAiVmlkZW8iLCAiVmlkZW9HYW1lcyIsICJXaXJlbGVz
c0FjY2Vzc29yaWVzIik7CgoJJGxpbmUgPSAiPGgzIGNsYXNzPVwicGxhaW5cIj4iOwoKCSRs
aW5lIC49ICI8YSBocmVmPVwiI2Fzdl9hbWF6b24yXCIgb25jbGljaz1cIiQoJyNhc3ZfYW1h
em9uMndyYXBwZXInKS5zbGlkZVRvZ2dsZSgnc2xvdycpOyByZXR1cm4gZmFsc2U7XCI+QW1h
em9uMjwvYT4iOwoKCSRsaW5lIC49ICI8L2gzPiI7CgoJJGZvcm0gPSAiPGZvcm0gb25TdWJt
aXQ9XCJhc3ZfbG9hZFJlc3VsdHMoKTsgcmV0dXJuIGZhbHNlO1wiPjxmaWVsZHNldD48bGVn
ZW5kPlNlYXJjaDwvbGVnZW5kPiIuCgoJCWdyYWYoIjxsYWJlbCBmb3I9XCJhc3ZfU2VhcmNo
SW5kZXhcIj5DaG9vc2UgYSBjYXRlZ29yeTwvbGFiZWw+PGJyIC8+Ii4KCgkJCXNlbGVjdElu
cHV0KCdhc3ZfU2VhcmNoSW5kZXgnLCAkYXN2X3NlYXJjaEluZGV4LCAkYXN2X3NlYXJjaElu
ZGV4LCB0cnVlLCcnLCdhc3ZfU2VhcmNoSW5kZXgnKSkuCgoJCWdyYWYoIjxsYWJlbCBmb3I9
XCJhc3ZfS2V5d29yZHNcIj5LZXl3b3JkczwvbGFiZWw+PGJyIC8+Ii4KCgkJCWZJbnB1dCgn
dGV4dCcsICdhc3ZfS2V5d29yZHMnLCAnJywgJ2VkaXQnLCAnJywgJycsICcyMCcsICAnJywg
J2Fzdl9LZXl3b3JkcycpKS4KCgkJZklucHV0KCdzdWJtaXQnLCdhc3ZfU2VhcmNoJywnU2Vh
cmNoJywicHVibGlzaCIsICcnLCAnYXN2X2xvYWRSZXN1bHRzKCk7cmV0dXJuIGZhbHNlOycs
ICcnLCAnJykuCgoJCWZJbnB1dCgnYnV0dG9uJywnYXN2X0NhbmNlbCcsJ0NhbmNlbCcsInB1
Ymxpc2giLCAnJywgJ2Fzdl9jYW5jZWxSZXN1bHRzKCk7cmV0dXJuIGZhbHNlOycsICcnLCAn
JykuCgoJCSI8L2ZpZWxkc2V0PjwvZm9ybT4iOwoKCSRsaW5lIC49ICI8ZGl2IGlkPVwiYXN2
X2FtYXpvbjJ3cmFwcGVyXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmVcIiA+PGRpdiBpZD1cImFz
dl9hbWF6b24yXCIgPiRmb3JtPC9kaXY+PGRpdiBpZD1cImFzdl9hbWF6b24yZm9ybVwiIHN0
eWxlPVwiZGlzcGxheTpub25lXCI+PC9kaXY+PGRpdiBpZD1cImFzdl9hbWF6b24yUmVzdWx0
c1wiIHN0eWxlPVwiZGlzcGxheTpub25lXCI+PC9kaXY+PC9kaXY+IjsKCgkkbGluZSA9IGFz
dl9zYWZlSlMoJGxpbmUpOwoKCSRycyA9IHNhZmVfY29sdW1uKCduYW1lJywgJ3R4cF9mb3Jt
JywgInR5cGUgPSAnbWlzYyciKTsKCgkkZm9ybXMgPSAnPHNlbGVjdCBpZD0iYXN2X2FtYXpv
bjJfZm9ybSI+PG9wdGlvbiAvPjwvc2VsZWN0Pic7CgoJaWYgKCRycykKCXsKCQkkZm9ybXMg
PSBzZWxlY3RJbnB1dCgnYXN2X2FtYXpvbjJfZm9ybScsICRycywgJGZvcm0sIHRydWUsICcn
LCAnYXN2X2FtYXpvbjJfZm9ybScpOwoJfQoJJGFzdl9hbWF6b24yX2ltYWdlc2l6ZSA9IGFy
cmF5KCdzbWFsbCcsICdtZWRpdW0nLCAnbGFyZ2UnKTsKCgkkZm9ybXMgLj0gZ3JhZignT1In
LgoJCQkJZ3JhZignQ3VzdG9tIC0gTk9UIEZVTkNUSU9OQUwnKS4KCQkJCSBncmFmKHNlbGVj
dElucHV0KCdhc3ZfYW1hem9uMl9jdXN0b21faW1hZ2VzaXplJywgJGFzdl9hbWF6b24yX2lt
YWdlc2l6ZSwgJGFzdl9hbWF6b24yX2ltYWdlc2l6ZSwgdHJ1ZSwgJycsICdhc3ZfYW1hem9u
Ml9jdXN0b21faW1hZ2VzaXplJykpLgoJCQkJIGdyYWYoY2hlY2tib3goJ2Fzdl9hbWF6b24y
X2N1c3RvbV9pbmNsdWRldGl0bGUnLCAnYXN2X2FtYXpvbjJfY3VzdG9tX2luY2x1ZGV0aXRs
ZScsICcxJywgJycsICdhc3ZfYW1hem9uMl9jdXN0b21faW5jbHVkZXRpdGxlJykuJzxsYWJl
bCBmb3I9ImFzdl9hbWF6b24yX2N1c3RvbV9pbmNsdWRldGl0bGUiPkluY2x1ZGUgdGl0bGU8
L2xhYmVsPicpLgoJCQkJIGdyYWYoY2hlY2tib3goJ2Fzdl9hbWF6b24yX2N1c3RvbV9pbmNs
dWRlbGluaycsICdhc3ZfYW1hem9uMl9jdXN0b21faW5jbHVkZWxpbmsnLCAnMScsICcnLCAn
YXN2X2FtYXpvbjJfY3VzdG9tX2luY2x1ZGVsaW5rJykuJzxsYWJlbCBmb3I9ImFzdl9hbWF6
b24yX2N1c3RvbV9pbmNsdWRlbGluayI+SW5jbHVkZSBsaW5rPC9sYWJlbCcpCgkJKTsKCSRm
b3JtcyA9IGFzdl9zYWZlSlMoJGZvcm1zKTsKCgkkanMgPSA8PDxFT0YKPFNDUklQVCBMQU5H
VUFHRT0iSmF2YVNjcmlwdCIgU1JDPSIvdGV4dHBhdHRlcm4vanF1ZXJ5LmpzIj4KPC9TQ1JJ
UFQ+CjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlw
dCI+CjwhLS0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQovL0F0dGFjaCB0aGUgYW1hem9uMiBwbHVnaW4gdG8gdGhl
IHBhZ2UKCiAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHsKCSQoIiRsaW5lIikuaW5z
ZXJ0QmVmb3JlKCIjd3JpdGUtc3RhdHVzIik7CiAgIH0pOwoKLy8tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlv
biBhc3ZfbG9hZFJlc3VsdHMoKQp7Cgl2YXIga2V5d29yZHMgPQkkKCIjYXN2X0tleXdvcmRz
IikudmFsKCk7Cgl2YXIgc2VhcmNoaW5kZXggPSAkKCIjYXN2X1NlYXJjaEluZGV4IG9wdGlv
bltAc2VsZWN0ZWRdIikudGV4dCgpOwoJYXN2X3JlcXVlc3Qoa2V5d29yZHMsIHNlYXJjaGlu
ZGV4LCAnMScpOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGFzdl9yZXF1ZXN0KGtleXdvcmRz
LCBzZWFyY2hpbmRleCwgaXRlbXBhZ2UpewoJJCgnI2Fzdl9hbWF6b24yZm9ybScpLmh0bWwo
JzxmaWVsZHNldD48bGVnZW5kPkNob29zZSBGb3JtPC9sZWdlbmQ+PGZvcm0+JGZvcm1zPC9m
b3JtPicpOwoJJCgnI2Fzdl9hbWF6b24yUmVzdWx0cycpLmh0bWwoJzxmaWVsZHNldD48bGVn
ZW5kPlJlc3VsdHM8L2xlZ2VuZD48ZGl2IGlkPSJhc3ZfYW1hem9uMlJlc3VsdHNEYXRhIj48
cCA+bG9hZGluZy4uLjwvcD48L2Rpdj48L2ZpZWxkc2V0PicpOwoJJCgiI2Fzdl9hbWF6b24y
UmVzdWx0c0RhdGEiKS5jc3MoInBhZGRpbmciLCAiMHB4IDBweCAxMHB4IDBweCIpOwoJJCgn
I2Fzdl9hbWF6b24yZm9ybScpLnNob3coJ3Nsb3cnKTsKCSQoJyNhc3ZfYW1hem9uMlJlc3Vs
dHMnKS5zaG93KCdzbG93Jyk7CgoJJC5nZXQoJ2luZGV4LnBocCcsCgkgCXthc3ZfYW1hem9u
Ml9hY3Rpb246ICIxIiwgYXN2X2tleXdvcmRzOiBlc2NhcGUoa2V5d29yZHMpLCBhc3Zfc2Vh
cmNoaW5kZXg6IGVzY2FwZShzZWFyY2hpbmRleCksIGFzdl9pdGVtcGFnZTogaXRlbXBhZ2Ug
fSwKCSAgIGFzdl9wYXJzZVJlc3BvbnNlLAoJICAgInhtbCIKCSApOwp9CgovLy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
CmZ1bmN0aW9uIGFzdl9wYXJzZVJlc3BvbnNlKHhtbCkKewoJdmFyIGl0ZW1QYWdlID0gJCgn
SXRlbVBhZ2UnLCB4bWwpLnRleHQoKTsKCXZhciBzZWFyY2hpbmRleCA9ICQoJ1NlYXJjaElu
ZGV4JywgeG1sKS50ZXh0KCk7Cgl2YXIgdG90YWxQYWdlcyA9ICQoJ1RvdGFsUGFnZXMnLCB4
bWwpLnRleHQoKTsKCXZhciBrZXl3b3JkcyA9ICQoJ0tleXdvcmRzJywgeG1sKS50ZXh0KCk7
Cgl2YXIgbGluZSA9IiI7CgoJbGluZSArPSBhc3ZfcHJldm5leHRfbGluayhrZXl3b3Jkcywg
c2VhcmNoaW5kZXgsIGl0ZW1QYWdlLCB0b3RhbFBhZ2VzLCAidG9wIik7CgoJJCh4bWwpLmZp
bmQoJ0l0ZW0nKS5lYWNoKGZ1bmN0aW9uKCl7CgkJdmFyIHRpdGxlID0gJCgnVGl0bGUnLHRo
aXMpLnRleHQoKTsKCQl2YXIgc0ltYWdlVVJMID0gJCgiU21hbGxJbWFnZSA+IFVSTCIsdGhp
cykudGV4dCgpOwoJCXZhciBtSW1hZ2VVUkwgPSAkKCJNZWRpdW1JbWFnZSA+IFVSTCIsdGhp
cykudGV4dCgpOwoJCXZhciBsSW1hZ2VVUkwgPSAkKCJMYXJnZUltYWdlID4gVVJMIix0aGlz
KS50ZXh0KCk7CgkJdmFyIHVybCA9ICQoJ0RldGFpbFBhZ2VVUkwnLHRoaXMpLnRleHQoKTsK
CQl2YXIgYXNpbiA9ICQoJ0FTSU4nLHRoaXMpLnRleHQoKTsKCgoJCXZhciBhbWF6b25IVE1M
ID0gJzxhIGhyZWY9IicrdXJsKyciPjxpbWcgc3JjPSInKyBzSW1hZ2VVUkwgKyciIHN0eWxl
PSJkaXNwbGF5OiBibG9jazttYXJnaW4tbGVmdDogYXV0bzttYXJnaW4tcmlnaHQ6IGF1dG87
Ii8+PHNwYW4gc3R5bGU9InRleHQtYWxpZ246IGNlbnRlciI+JyArIHRpdGxlICsgJzwvc3Bh
bj48L2E+JyA7CgoJCXZhciBmb3JtID0gJzxmb3JtIGlkPSJhc3ZfYW1hem9uMl8nK2FzaW4r
JyBvbnN1Ym1pdD0iYXN2X2FtYXpvbjJfYWRkdG9Cb2R5KFwnJythc2luKydcJykiPicgKwoJ
CQkJCSc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhc3ZfYW1hem9uMl90aXRsZSIgdmFs
dWU9IicrdGl0bGUrJyIgLz4nICsKCQkJCQknPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0i
YXN2X2FtYXpvbjJfc0ltYWdlVVJMIiB2YWx1ZSA9Iicrc0ltYWdlVVJMKyciIC8+JyArCgkJ
CQkJJzxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFzdl9hbWF6b24yX21JbWFnZVVSTCIg
dmFsdWUgPSInK21JbWFnZVVSTCsnIiAvPicgKwoJCQkJCSc8aW5wdXQgdHlwZT0iaGlkZGVu
IiBuYW1lPSJhc3ZfYW1hem9uMl9sSW1hZ2VVUkwiIHZhbHVlID0iJytsSW1hZ2VVUkwrJyIg
Lz4nICsKCQkJCQknPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYXN2X2FtYXpvbjJfdXJs
IiB2YWx1ZSA9IicrdXJsKyciIC8+JyArCgkJCQkJJzxpbnB1dCB0eXBlPSJoaWRkZW4iIG5h
bWU9ImFzdl9hbWF6b24yX2FzaW4iIHZhbHVlID0iJythc2luKyciIC8+JyArCgkJCQkJJzxp
bnB1dCB0eXBlPSJidXR0b24iIHN0eWxlPSJmbG9hdDpyaWdodCIgb25jbGljaz0iYXN2X2Ft
YXpvbjJfYWRkdG9Cb2R5KFwnJythc2luKydcJykiIGNsYXNzPSJwdWJsaXNoIiB2YWx1ZT0i
YWRkIiAvPicKCQkJCSAgICc8L2Zvcm0+JzsKCgkJbGluZSArPSAnPHA+JyArIGZvcm0gKyBh
bWF6b25IVE1MICArICc8L3A+JzsKICAgIH0pOwoKCWxpbmUgKz0gYXN2X3ByZXZuZXh0X2xp
bmsoa2V5d29yZHMsIHNlYXJjaGluZGV4LCBpdGVtUGFnZSwgdG90YWxQYWdlcywgImJvdHRv
bSIpOwoKICAgICQoIiNhc3ZfYW1hem9uMlJlc3VsdHNEYXRhIikuaHRtbChsaW5lKTsKCSQo
IiNhc3ZfYW1hem9uMlJlc3VsdHNEYXRhIikuY3NzKCJtYXgtaGVpZ2h0IiwgIjUwMHB4Iik7
CgkkKCIjYXN2X2FtYXpvbjJSZXN1bHRzRGF0YSIpLmNzcygib3ZlcmZsb3ciLCAiYXV0byIp
OwoJJCgiI2Fzdl9hbWF6b24yUmVzdWx0c0RhdGEiKS5jc3MoInBhZGRpbmciLCAiMHB4IDBw
eCAxMHB4IDBweCIpOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiQuZm4uYXBwZW5kVmFsID0gZnVuY3Rpb24o
dHh0KSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgdGhpcy52
YWx1ZSArPSB0eHQ7CiAgICB9KTsKCn07CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGFzdl9hbWF6
b24yX2FkZHRvQm9keShhc2luKQp7Cgl2YXIgZWxlbSA9ICQoJyNhc3ZfYW1hem9uMl8nK2Fz
aW4pOwoKCXZhciB0aXRsZSA9ICQoJ2lucHV0OmhpZGRlbltAbmFtZT1hc3ZfYW1hem9uMl90
aXRsZV0nKS52YWwoKTsKCXZhciBzSW1hZ2VVUkwgPSAkKCdpbnB1dDpoaWRkZW5bQG5hbWU9
YXN2X2FtYXpvbjJfc0ltYWdlVVJMXScpLnZhbCgpOwoJdmFyIG1JbWFnZVVSTCA9ICQoJ2lu
cHV0OmhpZGRlbltAbmFtZT1hc3ZfYW1hem9uMl9tSW1hZ2VVUkxdJykudmFsKCk7Cgl2YXIg
bEltYWdlVVJMID0gJCgnaW5wdXQ6aGlkZGVuW0BuYW1lPWFzdl9hbWF6b24yX2xJbWFnZVVS
TF0nKS52YWwoKTsKCXZhciB1cmwgPSAkKCdpbnB1dDpoaWRkZW5bQG5hbWU9YXN2X2FtYXpv
bjJfdXJsXScpLnZhbCgpOwoJdmFyIGZvcm0gPSAkKCIjYXN2X2FtYXpvbjJfZm9ybSBvcHRp
b25bQHNlbGVjdGVkXSIpLnRleHQoKTsKCglpZihmb3JtICE9ICIiKQoJewoJCSQuZ2V0KCdp
bmRleC5waHAnLAoJCQl7YXN2X2FtYXpvbjJfZm9ybV9hY3Rpb246ICIxIiwgYXN2X2FtYXpv
bjJfdGl0bGU6IHRpdGxlLCBhc3ZfYW1hem9uMl9hc2luOiBhc2luLCBhc3ZfYW1hem9uMl9z
SW1hZ2VVUkw6IHNJbWFnZVVSTCwgYXN2X2FtYXpvbjJfbUltYWdlVVJMOiBtSW1hZ2VVUkws
IGFzdl9hbWF6b24yX2xJbWFnZVVSTDogbEltYWdlVVJMLCBhc3ZfYW1hem9uMl91cmw6IHVy
bCwgYXN2X2FtYXpvbjJfZm9ybTogZm9ybSB9LAoJCSAgIGFzdl9hbWF6b24yX2FkZHRvQm9k
eV9SZXNwb25zZQoJCSApOwoJfQoJZWxzZQoJewoJCWFsZXJ0KCJJIGhhdmVuJ3QgaW1wbGVt
ZW50ZWQgdGhlIGN1c3RvbSBidWlsZGVyIHlldC4gWW91J2xsIGhhdmUgdG8gY3JlYXRlIGEg
Zm9ybSIpOwoJfQoJLyoKCQl2YXIgaW1hZ2VTaXplOwoJCXZhciBpbmNsdWRlVGl0bGU7CgkJ
dmFyIGluY2x1ZGVMaW5rOwoJCSQuZ2V0KCdpbmRleC5waHAnLAoJCQl7YXN2X2FtYXpvbjJf
Zm9ybV9hY3Rpb246ICIyIiwgYXN2X2FtYXpvbjJfdGl0bGU6IHRpdGxlLCBhc3ZfYW1hem9u
Ml9hc2luOiBhc2luLCBhc3ZfYW1hem9uMl9zSW1hZ2VVUkw6IHNJbWFnZVVSTCwgYXN2X2Ft
YXpvbjJfbUltYWdlVVJMOiBtSW1hZ2VVUkwsIGFzdl9hbWF6b24yX2xJbWFnZVVSTDogbElt
YWdlVVJMLCBhc3ZfYW1hem9uMl91cmw6IHVybCwgYXN2X2FtYXpvbjJfZm9ybTogZm9ybSB9
LAoJCSAgIGFzdl9hbWF6b24yX2FkZHRvQm9keV9SZXNwb25zZQoJKi8KfQoKLy8tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CgpmdW5jdGlvbiBhc3ZfYW1hem9uMl9hZGR0b0JvZHlfUmVzcG9uc2UocmVzcG9uc2UpCnsK
CSQoJyNib2R5JykuYXBwZW5kVmFsKCdcXG4nICsgcmVzcG9uc2UpOwp9CgovLy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
Ly9BZGQgdGhlIEFtYXpvbiBpbmZvcm1hdGlvbiB0byB0aGUgYm9keSBvZiB0aGUgYXJ0aWNs
ZQoKZnVuY3Rpb24gYXN2X29uQ2xpY2soZWxlbSkKewoJJCgnI2JvZHknKS5hcHBlbmQoIiBh
Iik7Cn0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYXN2X2NhbmNlbFJlc3VsdHMoKQp7CgkkKCcj
YXN2X2FtYXpvbjJSZXN1bHRzJykuaGlkZSgnc2xvdycpOwoJJCgnI2Fzdl9hbWF6b24yZm9y
bScpLmhpZGUoJ3Nsb3cnKTsKfQoKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBhc3ZfcHJldm5leHRf
bGluayhrZXl3b3Jkcywgc2VhcmNoaW5kZXgsIGl0ZW1QYWdlLCB0b3RhbFBhZ2VzLCBsb2Mp
CnsKCWxpbmUgPSAnJzsKCglpZihwYXJzZUludCh0b3RhbFBhZ2VzKT4xKQoJewoJCWlmKGxv
Yz09ImJvdHRvbSIpIGxpbmUrPSc8aHIgLz4nOwoKCQlsaW5lKz0nPHAgc3R5bGU9InRleHQt
YWxpZ246IGNlbnRlcjsiPic7CgoJCWl0ZW1QYWdlID0gcGFyc2VJbnQoaXRlbVBhZ2UpOwoK
CQl2YXIgdGV4dCA9ICcnOwoKCQlpZihpdGVtUGFnZT4xKQoJCXsKCQkJdmFyIHBJdGVtUGFn
ZSA9IGl0ZW1QYWdlIC0gMTsKCgkJCWxpbmUgKz0gJzxhIGhyZWY9IiMiIG9uY2xpY2s9ImFz
dl9yZXF1ZXN0KFwnJytrZXl3b3JkcyArICdcJyxcJycgKyBzZWFyY2hpbmRleCArICdcJyxc
JycrIHBJdGVtUGFnZSsnXCcpO3JldHVybiBmYWxzZTsiPnByZXZpb3VzPC9hPiB8ICc7CgoJ
CX0KCQlpZihpdGVtUGFnZTx0b3RhbFBhZ2VzKQoJCXsKCQkJdmFyIG5JdGVtUGFnZSA9IGl0
ZW1QYWdlICsgMTsKCgkJCWxpbmUgKz0gJzxhIGhyZWY9IiMiIG9uY2xpY2s9ImFzdl9yZXF1
ZXN0KFwnJytrZXl3b3JkcyArICdcJyxcJycgKyBzZWFyY2hpbmRleCArICdcJyxcJycrIG5J
dGVtUGFnZSsnXCcpO3JldHVybiBmYWxzZTsiPm5leHQ8L2E+JzsKCgkJfQoKCQlsaW5lKz0n
PC9wPic7CgoJCWlmKGxvYz09InRvcCIpIGxpbmUrPSc8aHIgLz4nOwoJfQoKCXJldHVybiBs
aW5lOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KCi8vIC0tPgo8L3NjcmlwdD4KRU9GOwoJZWNobyAkanM7Cn0K
Ci8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQoKZnVuY3Rpb24gYXN2X3NhZmVKUygkbGluZSkKewoJcmV0dXJuIHN0cl9y
ZXBsYWNlKCJcbiIsICIiLCBhZGRzbGFzaGVzKCRsaW5lKSk7Cn0KCi8vLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKY2xh
c3MgYXN2X0FtYXpvbgp7Cgl2YXIgJGFwaV9rZXkgPSAiMFk4RjFZVjFOMllTR0oxTUMyMDIi
OwoJdmFyICRjb250ZW50VHlwZSA9ICJ0ZXh0JTJGeG1sIjsKCXZhciAkb3BlcmF0aW9uID0g
Ikl0ZW1TZWFyY2giOwoJdmFyICRzZXJ2aWNlID0gIkFXU0VDb21tZXJjZVNlcnZpY2UiOwoJ
dmFyICRiYXNlVVJMID0gImh0dHA6Ly9lY3MuYW1hem9uYXdzLmNvbS9vbmNhL3htbD8iOwoJ
dmFyICRzZWFyY2hJbmRleCA9ICJCbGVuZGVkIjsKCXZhciAkcmVzcG9uc2VHcm91cCA9ICJJ
bWFnZXMsU21hbGwiOwoJdmFyICR2ZXJzaW9uID0gIjIwMDUtMDMtMjMiOwoJdmFyICRsb2Nh
bGU7CgoJLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCgoJZnVuY3Rpb24gYXN2X0FtYXpvbigkbG9jYWxlKQoJewoJCSR0
aGlzLT4kbG9jYWxlID0gJGxvY2FsZTsKCX0KCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCglmdW5jdGlvbiByZXF1
ZXN0KCRrZXl3b3JkcywgJHNlYXJjaGluZGV4LCAkaXRlbVBhZ2UgPSAiMSIpCgl7CgkJJHVy
bCA9ICR0aGlzLT5idWlsZFVSTChkb1NsYXNoKCRrZXl3b3JkcyksIGRvU2xhc2goJHNlYXJj
aGluZGV4KSwgZG9TbGFzaCgkaXRlbVBhZ2UpKTsKCgkJLy8gY3JlYXRlIGEgbmV3IGN1cmwg
cmVzb3VyY2UKCQkkY2ggPSBjdXJsX2luaXQoKTsKCgkJLy8gc2V0IFVSTCBhbmQgb3RoZXIg
YXBwcm9wcmlhdGUgb3B0aW9ucwoJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1
cmwpOwoKCQkvLyBncmFiIFVSTCBhbmQgcGFzcyBpdCB0byB0aGUgYnJvd3NlcgoJCWN1cmxf
ZXhlYygkY2gpOwoKCQkvLyBjbG9zZSBjdXJsIHJlc291cmNlLCBhbmQgZnJlZSB1cCBzeXN0
ZW0gcmVzb3VyY2VzCgkJY3VybF9jbG9zZSgkY2gpOwoJfQoKCS8vLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCWZ1bmN0
aW9uIGJ1aWxkVVJMIC8qIHByaXZhdGUgKi8oJGtleXdvcmRzLCAkc2VhcmNoaW5kZXgsICRp
dGVtUGFnZSA9ICIxIikKCXsKCQkkdXJsID0gJHRoaXMtPmJhc2VVUkwuCgkJCQkiU2Vydmlj
ZT0iLiR0aGlzLT5zZXJ2aWNlLgoJCQkJIiZPcGVyYXRpb249Ii4kdGhpcy0+b3BlcmF0aW9u
LgoJCQkJIiZTdWJzY3JpcHRpb25JZD0iLiR0aGlzLT5hcGlfa2V5LgoJCQkJIiZTZWFyY2hJ
bmRleD0iLiRzZWFyY2hpbmRleC4KCQkJCSImS2V5d29yZHM9Ii4ka2V5d29yZHMuCgkJCQki
JlJlc3BvbnNlR3JvdXA9Ii4kdGhpcy0+cmVzcG9uc2VHcm91cC4KCQkJCSImSXRlbVBhZ2U9
Ii4kaXRlbVBhZ2UuIiZWZXJzaW9uPSIuJHRoaXMtPnZlcnNpb247CgoJCXJldHVybiAkdXJs
OwoJfQoKCS8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIjtzOjM6Im1kNSI7czozMjoiNmQ0MzA5
MDU4ZmU1ZDIxNDZmNTlhNzVhYzI2YzVmYzkiO30=
