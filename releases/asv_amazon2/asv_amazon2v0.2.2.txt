# asv_amazon2 v0.2
# Add Amazon items to your TXP article
# Amit Varia
# http://www.amitvaria.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjQ6Im5hbWUiO3M6MTE6ImFzdl9hbWF6b24yIjtzOjc6InZlcnNpb24iO3M6Mzoi
MC4yIjtzOjY6ImF1dGhvciI7czoxMDoiQW1pdCBWYXJpYSI7czoxMDoiYXV0aG9yX3VyaSI7
czoyNToiaHR0cDovL3d3dy5hbWl0dmFyaWEuY29tLyI7czoxMToiZGVzY3JpcHRpb24iO3M6
MzY6IkFkZCBBbWF6b24gaXRlbXMgdG8geW91ciBUWFAgYXJ0aWNsZSI7czo0OiJ0eXBlIjtp
OjE7czo0OiJoZWxwIjtzOjIxOTQ6Igk8aDE+YXN2X2FtYXpvbjI8L2gxPgoKCTxoMj52ZXJz
aW9uIDAuMjwvaDI+CgoJPGgzPldoYXQmIzgyMTc7cyBuZXc/PC9oMz4KCgk8cD5BIGxvbmcg
dGltZSBhZ28sIEkgY3JlYXRlZCBhIHBsdWdpbiBjYWxsZWQgYXN2X2FtYXpvbiwgd2hpY2gg
bGV0IHlvdSBkaXNwbGF5IHByb2R1Y3RzIGZyb20gQW1hem9uIG9uIHlvdXIgc2l0ZS4gSXQg
d29ya2VkLCBidXQgaW5zZXJ0aW5nIHRoZSBwcm9kdWN0IHJlcXVpcmVkIHlvdSB0byBnbyB0
byBBbWF6b24sIGNvcHkgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5BU0lOPC9zcGFuPiBudW1i
ZXIsIGFuZCBwYXN0ZSBpbnRvIHRoZSBUZXh0UGF0dGVybi4gV2hhdCBhIGhhc3NsZSEgV2Vs
bCBJIGZpbmFsbHkgZ290IGFyb3VuZCB0byB3cml0aW5nIHRoZSBuZXh0IHZlcnNpb24gb2Yg
YXN2X2FtYXpvbi4gSSYjODIxNzt2ZSBjYWxsZWQgaXQgYXN2X2FtYXpvbjIgc2luY2UgaXQg
aXMgY29tcGxldGVseSB3cml0dGVuIGFuZCB3b3JrcyBpbiBhIHdob2xlIG5ldyB3YXkuPC9w
PgoKCTxoMz5Ib3cgZG9lcyBpdCB3b3JrPzwvaDM+CgoJPHA+U2ltcGxlICYjODIxMTsgd2hl
biB3cml0aW5nIGFuIGFydGljbGUganVzdCBjbGljayBvbiB0aGUgJiM4MjIwO0FtYXpvbjIm
IzgyMjE7IGxpbmsgaW4gdGhlIHRvcCByaWdodCBjb2x1bW4uIFlvdSBjYW4gc2VhcmNoIGFu
ZCBhZGQgcHJvZHVjdHMgdG8geW91ciBwb3N0IGJ5IGNsaWNraW5nIHRoZSAmIzgyMjA7YWRk
JiM4MjIxOyBidXR0b24gbmV4dCB0byBlYWNoIGl0ZW0uPC9wPgoKCTxoMz5DcmVhdGluZyBh
IGZvcm08L2gzPgoKCTxwPldpdGggdmVyc2lvbiAwLjIsIHlvdSB3aWxsIGhhdmUgdG8gaGF2
ZSBmb3JtcyB0byBnZW5lcmF0ZSB0aGUgbGF5b3V0IG9mIHRoZSBwcm9kdWN0IG9uIHlvdXIg
cGFnZS4gV2hlbiBjcmVhdGluZyBhIG5ldyAmIzgyMTY7bWlzYyYjODIxNzsgZm9ybSB5b3Ug
Y2FuIHVzZSB0aGUgZm9sbG93aW5nIHZhbHVlczo8L3A+CgoJPHA+YXN2X2FtYXpvbjJfdXJs
PGJyIC8+CmFzdl9hbWF6b24yX3NJbWFnZVVybDxiciAvPgphc3ZfYW1hem9uMl9tSW1hZ2VV
cmw8YnIgLz4KYXN2X2FtYXpvbjJfbEltYWdlVXJsPGJyIC8+CmFzdl9hbWF6b24yX2FzaW48
YnIgLz4KYXN2X2FtYXpvbjJfdGl0bGU8L3A+CgoJPHA+YXN2X2FtYXpvbjIgd2lsbCBqdXN0
IHJlcGxhY2UgdGhlc2UgbGl0ZXJhbHMgd2l0aCB0aGVpciBwcm9kdWN0IGNvdW50ZXJwYXJ0
LCBzbzo8L3A+Cgo8cHJlPjxjb2RlPiYjNjA7YSBocmVmPSYjMzQ7YXN2X2FtYXpvbjJfdXJs
JiMzNDsmIzYyOyYjNjA7aW1nIHNyYz0mIzM0O2Fzdl9hbWF6b24yX3NJbWFnZVVybCYjMzQ7
IC8mIzYyOyYjNjA7YnIgLyYjNjI7YXN2X2FtYXpvbjJfdGl0bGUmIzYwOy9hJiM2MjsKPC9j
b2RlPjwvcHJlPgoKCTxwPnJldHVybnM6PC9wPgoKPHByZT48Y29kZT4mIzYwO2EgaHJlZj0m
IzM0O2h0dHA6Ly93d3cuYW1hem9uLmNvbS9ncC9yZWRpcmVjdC5odG1sJTNGQVNJTj0xNTkw
NTk4MzI2JTI2dGFnPXdzJTI2bGNvZGU9eG0yJTI2Y0lEPTIwMjUlMjZjY21JRD0xNjU5NTMl
MjZsb2NhdGlvbj0vby9BU0lOLzE1OTA1OTgzMjYlMjUzRlN1YnNjcmlwdGlvbklkPTBZOEYx
WVYxTjJZU0dKMU1DMjAyJiMzNDsmIzYyOyYjNjA7aW1nIHNyYz0mIzM0O2h0dHA6Ly9lYzEu
aW1hZ2VzLWFtYXpvbi5jb20vaW1hZ2VzL0kvMDF5YXExZXRqS0wuanBnJiMzNDsgLyYjNjI7
JiM2MDticiAvJiM2MjtUZXh0cGF0dGVybiBTb2x1dGlvbnM6IFBIUC1CYXNlZCBDb250ZW50
IE1hbmFnZW1lbnQgTWFkZSBFYXN5IChTb2x1dGlvbnMpJiM2MDsvYSYjNjI7CndoaWNoIHdp
bGwgZGlzcGxheSBsaWtlIHRoaXM6CjwvY29kZT48L3ByZT4KCgk8cD48YSBocmVmPSJodHRw
Oi8vd3d3LmFtYXpvbi5jb20vZ3AvcmVkaXJlY3QuaHRtbCUzRkFTSU49MTU5MDU5ODMyNiUy
NnRhZz13cyUyNmxjb2RlPXhtMiUyNmNJRD0yMDI1JTI2Y2NtSUQ9MTY1OTUzJTI2bG9jYXRp
b249L28vQVNJTi8xNTkwNTk4MzI2JTI1M0ZTdWJzY3JpcHRpb25JZD0wWThGMVlWMU4yWVNH
SjFNQzIwMiI+PGltZyBzcmM9Imh0dHA6Ly9lYzEuaW1hZ2VzLWFtYXpvbi5jb20vaW1hZ2Vz
L0kvMDF5YXExZXRqS0wuanBnIiAvPjxiciAvPgpUZXh0cGF0dGVybiBTb2x1dGlvbnM6IFBI
UC1CYXNlZCBDb250ZW50IE1hbmFnZW1lbnQgTWFkZSBFYXN5IChTb2x1dGlvbnMpPC9hPjwv
cD4iO3M6NDoiY29kZSI7czoxMjY2NzoiLy8gYXN2X2FtYXpvbjIKLy8gRGVzaWduZWQgYXJv
dW5kIHRoZSBuZWVkIHRvIGluY2x1ZGUgaXRlbXMgZnJvbSBBbWF6b24gaW4geW91ciB3ZWJz
aXRlCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQoKaWYoJ2FkbWluJyA9PSBAdHhwaW50ZXJmYWNlKQp7CglyZWdpc3Rl
cl9jYWxsYmFjaygnYXN2X2FtYXpvbjInLCAnYXJ0aWNsZScpOwp9CgovLy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmlm
KGdwcygnYXN2X2FtYXpvbjJfYWN0aW9uJykgJiYgZ3BzKCdhc3Zfa2V5d29yZHMnKSkKewoJ
JGFzdl9hbWF6b24gPSBuZXcgYXN2X0FtYXpvbigiVVMiKTsKCWhlYWRlcignQ29udGVudC1U
eXBlOiB0ZXh0L3htbCcpOwoJZWNobyAkYXN2X2FtYXpvbi0+cmVxdWVzdChncHMoJ2Fzdl9r
ZXl3b3JkcycpLCBncHMoJ2Fzdl9zZWFyY2hpbmRleCcpLCBncHMoJ2Fzdl9pdGVtcGFnZScp
KTsKCWV4aXQ7Cn0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKaWYoZ3BzKCdhc3ZfYW1hem9uMl9mb3JtX2FjdGlv
bicpKQp7CgkkZm9ybSA9IGdwcygnYXN2X2FtYXpvbjJfZm9ybScpOwoKCSRhc3ZfYW1hem9u
Ml9jb250ZW50cyA9IGFycmF5KCk7CgkkYXN2X2FtYXpvbjJfY29udGVudHNbJ2Fzdl9hbWF6
b24yX3VybCddID0gZ3BzKCdhc3ZfYW1hem9uMl91cmwnKTsKCSRhc3ZfYW1hem9uMl9jb250
ZW50c1snYXN2X2FtYXpvbjJfc0ltYWdlVXJsJ10gPSBncHMoJ2Fzdl9hbWF6b24yX3NJbWFn
ZVVSTCcpOwoJJGFzdl9hbWF6b24yX2NvbnRlbnRzWydhc3ZfYW1hem9uMl9tSW1hZ2VVcmwn
XSA9IGdwcygnYXN2X2FtYXpvbjJfbUltYWdlVVJMJyk7CgkkYXN2X2FtYXpvbjJfY29udGVu
dHNbJ2Fzdl9hbWF6b24yX2xJbWFnZVVybCddID0gZ3BzKCdhc3ZfYW1hem9uMl9sSW1hZ2VV
UkwnKTsKCSRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpvbjJfYXNpbiddID0gZ3Bz
KCdhc3ZfYW1hem9uMl91cmwnKTsKCSRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpv
bjJfdGl0bGUnXSA9IGdwcygnYXN2X2FtYXpvbjJfdGl0bGUnKTsKCglpZigkZm9ybSkKCXsK
CQkkYXN2X2FtYXpvbjJfZm9ybSA9IGZldGNoX2Zvcm0oJGZvcm0pOwoJCWZvcmVhY2goJGFz
dl9hbWF6b24yX2NvbnRlbnRzIGFzICRrZXk9PiR2YWx1ZSkKCQl7CgkJCSRhc3ZfYW1hem9u
Ml9mb3JtID0gc3RyX3JlcGxhY2UoJGtleSwgJHZhbHVlLCAJJGFzdl9hbWF6b24yX2Zvcm0p
OwoJCX0KCX0KCWVsc2UKCXsKCQkkYXN2X2FtYXpvbjJfZm9ybSA9ICI8YSBocmVmPVwiIi4k
YXN2X2FtYXpvbjJfY29udGVudHNbJ2Fzdl9hbWF6b24yX3VybCddLiJcIj48aW1nIHNyYz1c
IiIuJGFzdl9hbWF6b24yX2NvbnRlbnRzWydhc3ZfYW1hem9uMl9zSW1hZ2VVcmwnXS4iXCIg
Lz48YnIgLz4iLiRhc3ZfYW1hem9uMl9jb250ZW50c1snYXN2X2FtYXpvbjJfdGl0bGUnXS4i
PC9hPjxiciAvPiI7Cgl9CgoJZWNobygkYXN2X2FtYXpvbjJfZm9ybSk7CgoJZXhpdDsKfQoK
Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCgpmdW5jdGlvbiBhc3ZfYW1hem9uMiAoJGV2ZW50LCAkc3RlcCkKewoJJGFz
dl9zZWFyY2hJbmRleCA9IGFycmF5KCJBcHBhcmVsIiwgIkJhYnkiLCAiQmxlbmRlZCIsICJC
b29rcyIsICJDbGFzc2ljYWwiLCAiRFZEIiwgIkRpZ2l0YWxNdXNpYyIsICJFbGVjdHJvbmlj
cyIsICJHb3VybWV0Rm9vZCIsICJIZWFsdGhQZXJzb25hbENhcmUiLCAiSmV3ZWxyeSIsICJL
aXRjaGVuIiwgIk1hZ2F6aW5lcyIsICJNZXJjaGFudHMiLCAiTWlzY2VsbGFuZW91cyIsICJN
dXNpYyIsICJNdXNpY1RyYWNrcyIsICJNdXNpY2FsSW5zdHJ1bWVudHMiLCAiT2ZmaWNlUHJv
ZHVjdHMiLCAiT3V0ZG9vckxpdmluZyIsICJQQ0hhcmR3YXJlIiwgIlBldFN1cHBsaWVzIiwg
IlBob3RvIiwgIlJlc3RhdXJhbnRzIiwgIlNvZnR3YXJlIiwgIlNwb3J0aW5nR29vZHMiLCAi
VG9vbHMiLCAiVG95cyIsICJWSFMiLCAiVmlkZW8iLCAiVmlkZW9HYW1lcyIsICJXaXJlbGVz
c0FjY2Vzc29yaWVzIik7CgoJJGxpbmUgPSAiPGgzIGNsYXNzPVwicGxhaW5cIj4iOwoKCSRs
aW5lIC49ICI8YSBocmVmPVwiI2Fzdl9hbWF6b24yXCIgb25jbGljaz1cIiQoJyNhc3ZfYW1h
em9uMndyYXBwZXInKS5zbGlkZVRvZ2dsZSgnc2xvdycpOyByZXR1cm4gZmFsc2U7XCI+QW1h
em9uMjwvYT4iOwoKCSRsaW5lIC49ICI8L2gzPiI7CgoJJGZvcm0gPSAiPGZvcm0gb25TdWJt
aXQ9XCJhc3ZfbG9hZFJlc3VsdHMoKTsgcmV0dXJuIGZhbHNlO1wiPjxoMz5BbWF6b24yPC9o
Mz48cCBpZD1cImFzdl9hbWF6b24yX2Nsb3NlXCI+PGEgaHJlZj1cIiNcIiBvbmNsaWNrPVwi
JCgnI2Fzdl9hbWF6b24yd3JhcHBlcicpLnNsaWRlVG9nZ2xlKCdzbG93Jyk7IHJldHVybiBm
YWxzZTtcIj5jbG9zZTwvYT48L3A+PGZpZWxkc2V0PjxsZWdlbmQ+U2VhcmNoPC9sZWdlbmQ+
Ii4KCgkJZ3JhZigiPGxhYmVsIGZvcj1cImFzdl9TZWFyY2hJbmRleFwiPkNob29zZSBhIGNh
dGVnb3J5PC9sYWJlbD48YnIgLz4iLgoKCQkJc2VsZWN0SW5wdXQoJ2Fzdl9TZWFyY2hJbmRl
eCcsICRhc3Zfc2VhcmNoSW5kZXgsICRhc3Zfc2VhcmNoSW5kZXgsIHRydWUsJycsJ2Fzdl9T
ZWFyY2hJbmRleCcpKS4KCgkJZ3JhZigiPGxhYmVsIGZvcj1cImFzdl9LZXl3b3Jkc1wiPktl
eXdvcmRzPC9sYWJlbD48YnIgLz4iLgoKCQkJZklucHV0KCd0ZXh0JywgJ2Fzdl9LZXl3b3Jk
cycsICcnLCAnZWRpdCcsICcnLCAnJywgJzIwJywgICcnLCAnYXN2X0tleXdvcmRzJykpLgoK
CQlmSW5wdXQoJ3N1Ym1pdCcsJ2Fzdl9TZWFyY2gnLCdTZWFyY2gnLCJwdWJsaXNoIiwgJycs
ICdhc3ZfbG9hZFJlc3VsdHMoKTtyZXR1cm4gZmFsc2U7JywgJycsICcnKS4KCgkJZklucHV0
KCdidXR0b24nLCdhc3ZfQ2FuY2VsJywnQ2FuY2VsJywicHVibGlzaCIsICcnLCAnYXN2X2Nh
bmNlbFJlc3VsdHMoKTtyZXR1cm4gZmFsc2U7JywgJycsICcnKS4KCgkJIjwvZmllbGRzZXQ+
PC9mb3JtPiI7CgoJJGxpbmUgLj0gIjxkaXYgaWQ9XCJhc3ZfYW1hem9uMndyYXBwZXJcIiBz
dHlsZT1cImRpc3BsYXk6bm9uZVwiID48ZGl2IGlkPVwiYXN2X2FtYXpvbjJcIiA+JGZvcm08
L2Rpdj48ZGl2IGlkPVwiYXN2X2FtYXpvbjJmb3JtXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmVc
Ij48L2Rpdj48ZGl2IGlkPVwiYXN2X2FtYXpvbjJSZXN1bHRzXCIgc3R5bGU9XCJkaXNwbGF5
Om5vbmVcIj48L2Rpdj48L2Rpdj4iOwoKCSRsaW5lID0gYXN2X3NhZmVKUygkbGluZSk7CgoJ
JHJzID0gc2FmZV9jb2x1bW4oJ25hbWUnLCAndHhwX2Zvcm0nLCAidHlwZSA9ICdtaXNjJyIp
OwoKCSRmb3JtcyA9ICc8c2VsZWN0IGlkPSJhc3ZfYW1hem9uMl9mb3JtIj48b3B0aW9uIC8+
PC9zZWxlY3Q+JzsKCglpZiAoJHJzKQoJewoJCSRmb3JtcyA9IHNlbGVjdElucHV0KCdhc3Zf
YW1hem9uMl9mb3JtJywgJHJzLCAkZm9ybSwgdHJ1ZSwgJycsICdhc3ZfYW1hem9uMl9mb3Jt
Jyk7Cgl9CgkkYXN2X2FtYXpvbjJfaW1hZ2VzaXplID0gYXJyYXkoJ3NtYWxsJywgJ21lZGl1
bScsICdsYXJnZScpOwoKCSRmb3JtcyAuPSBncmFmKCdPUicuCgkJCQlncmFmKCdDdXN0b20g
LSBOT1QgRlVOQ1RJT05BTCcpLgoJCQkJIGdyYWYoc2VsZWN0SW5wdXQoJ2Fzdl9hbWF6b24y
X2N1c3RvbV9pbWFnZXNpemUnLCAkYXN2X2FtYXpvbjJfaW1hZ2VzaXplLCAkYXN2X2FtYXpv
bjJfaW1hZ2VzaXplLCB0cnVlLCAnJywgJ2Fzdl9hbWF6b24yX2N1c3RvbV9pbWFnZXNpemUn
KSkuCgkJCQkgZ3JhZihjaGVja2JveCgnYXN2X2FtYXpvbjJfY3VzdG9tX2luY2x1ZGV0aXRs
ZScsICdhc3ZfYW1hem9uMl9jdXN0b21faW5jbHVkZXRpdGxlJywgJzEnLCAnJywgJ2Fzdl9h
bWF6b24yX2N1c3RvbV9pbmNsdWRldGl0bGUnKS4nPGxhYmVsIGZvcj0iYXN2X2FtYXpvbjJf
Y3VzdG9tX2luY2x1ZGV0aXRsZSI+SW5jbHVkZSB0aXRsZTwvbGFiZWw+JykuCgkJCQkgZ3Jh
ZihjaGVja2JveCgnYXN2X2FtYXpvbjJfY3VzdG9tX2luY2x1ZGVsaW5rJywgJ2Fzdl9hbWF6
b24yX2N1c3RvbV9pbmNsdWRlbGluaycsICcxJywgJycsICdhc3ZfYW1hem9uMl9jdXN0b21f
aW5jbHVkZWxpbmsnKS4nPGxhYmVsIGZvcj0iYXN2X2FtYXpvbjJfY3VzdG9tX2luY2x1ZGVs
aW5rIj5JbmNsdWRlIGxpbms8L2xhYmVsJykKCQkpOwoJJGZvcm1zID0gYXN2X3NhZmVKUygk
Zm9ybXMpOwoKCSRqcyA9IDw8PEVPRgo8U0NSSVBUIExBTkdVQUdFPSJKYXZhU2NyaXB0IiBT
UkM9Ii90ZXh0cGF0dGVybi9qcXVlcnkuanMiPgo8L1NDUklQVD4KPHNjcmlwdCBsYW5ndWFn
ZT0iamF2YXNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KPCEtLQoKLy8tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
Ci8vQXR0YWNoIHRoZSBhbWF6b24yIHBsdWdpbiB0byB0aGUgcGFnZQoKICQoZG9jdW1lbnQp
LnJlYWR5KGZ1bmN0aW9uKCkgewoJJCgiJGxpbmUiKS5pbnNlcnRCZWZvcmUoJCgiI2FkdmFu
Y2VkIikucHJldigpKTsKCgkkKCIjYXN2X2FtYXpvbjJ3cmFwcGVyIikuY3NzKCJwb3NpdGlv
biIsICJhYnNvbHV0ZSIpOwoJJCgiI2Fzdl9hbWF6b24yd3JhcHBlciIpLmNzcygidG9wIiwg
IjgwcHgiKTsKCSQoIiNhc3ZfYW1hem9uMndyYXBwZXIiKS5jc3MoInJpZ2h0IiwgIjBweCIp
OwoJJCgiI2Fzdl9hbWF6b24yd3JhcHBlciIpLmNzcygid2lkdGgiLCAiMjAwcHgiKTsKCSQo
IiNhc3ZfYW1hem9uMndyYXBwZXIiKS5jc3MoImJhY2tncm91bmQtY29sb3IiLCAiI2ZmZSIp
OwoJJCgiI2Fzdl9hbWF6b24yd3JhcHBlciIpLmNzcygicGFkZGluZyIsICIyMHB4Iik7Cgkk
KCIjYXN2X2FtYXpvbjJ3cmFwcGVyID4gaDMiKS5jc3MoImZsb2F0IiwgImxlZnQiKTsKCSQo
IiNhc3ZfYW1hem9uMndyYXBwZXIgPiBoMyIpLmNzcygiZGlzcGxheSIsICJpbmxpbmUiKTsK
CSQoIiNhc3ZfYW1hem9uMl9jbG9zZSIpLmNzcygidGV4dC1hbGlnbiIsICJyaWdodCIpOwog
ICB9KTsKCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYXN2X2xvYWRSZXN1bHRzKCkKewoJdmFyIGtl
eXdvcmRzID0JJCgiI2Fzdl9LZXl3b3JkcyIpLnZhbCgpOwoJdmFyIHNlYXJjaGluZGV4ID0g
JCgiI2Fzdl9TZWFyY2hJbmRleCBvcHRpb25bQHNlbGVjdGVkXSIpLnRleHQoKTsKCWFzdl9y
ZXF1ZXN0KGtleXdvcmRzLCBzZWFyY2hpbmRleCwgJzEnKTsKfQoKLy8tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5j
dGlvbiBhc3ZfcmVxdWVzdChrZXl3b3Jkcywgc2VhcmNoaW5kZXgsIGl0ZW1wYWdlKXsKCSQo
JyNhc3ZfYW1hem9uMmZvcm0nKS5odG1sKCc8ZmllbGRzZXQ+PGxlZ2VuZD5DaG9vc2UgRm9y
bTwvbGVnZW5kPjxmb3JtPiRmb3JtczwvZm9ybT4nKTsKCSQoJyNhc3ZfYW1hem9uMlJlc3Vs
dHMnKS5odG1sKCc8ZmllbGRzZXQ+PGxlZ2VuZD5SZXN1bHRzPC9sZWdlbmQ+PGRpdiBpZD0i
YXN2X2FtYXpvbjJSZXN1bHRzRGF0YSI+PHAgPmxvYWRpbmcuLi48L3A+PC9kaXY+PC9maWVs
ZHNldD4nKTsKCSQoIiNhc3ZfYW1hem9uMlJlc3VsdHNEYXRhIikuY3NzKCJwYWRkaW5nIiwg
IjBweCAwcHggMTBweCAwcHgiKTsKCSQoJyNhc3ZfYW1hem9uMmZvcm0nKS5zaG93KCdzbG93
Jyk7CgkkKCcjYXN2X2FtYXpvbjJSZXN1bHRzJykuc2hvdygnc2xvdycpOwoKCSQuZ2V0KCdp
bmRleC5waHAnLAoJIAl7YXN2X2FtYXpvbjJfYWN0aW9uOiAiMSIsIGFzdl9rZXl3b3Jkczog
ZXNjYXBlKGtleXdvcmRzKSwgYXN2X3NlYXJjaGluZGV4OiBlc2NhcGUoc2VhcmNoaW5kZXgp
LCBhc3ZfaXRlbXBhZ2U6IGl0ZW1wYWdlIH0sCgkgICBhc3ZfcGFyc2VSZXNwb25zZSwKCSAg
ICJ4bWwiCgkgKTsKfQoKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBhc3ZfcGFyc2VSZXNwb25zZSh4
bWwpCnsKCXZhciBpdGVtUGFnZSA9ICQoJ0l0ZW1QYWdlJywgeG1sKS50ZXh0KCk7Cgl2YXIg
c2VhcmNoaW5kZXggPSAkKCdTZWFyY2hJbmRleCcsIHhtbCkudGV4dCgpOwoJdmFyIHRvdGFs
UGFnZXMgPSAkKCdUb3RhbFBhZ2VzJywgeG1sKS50ZXh0KCk7Cgl2YXIga2V5d29yZHMgPSAk
KCdLZXl3b3JkcycsIHhtbCkudGV4dCgpOwoJdmFyIGxpbmUgPSIiOwoKCWxpbmUgKz0gYXN2
X3ByZXZuZXh0X2xpbmsoa2V5d29yZHMsIHNlYXJjaGluZGV4LCBpdGVtUGFnZSwgdG90YWxQ
YWdlcywgInRvcCIpOwoKCSQoeG1sKS5maW5kKCdJdGVtJykuZWFjaChmdW5jdGlvbigpewoJ
CXZhciB0aXRsZSA9ICQoJ1RpdGxlJyx0aGlzKS50ZXh0KCk7CgkJdmFyIHNJbWFnZVVSTCA9
ICQoIlNtYWxsSW1hZ2UgPiBVUkwiLHRoaXMpLnRleHQoKTsKCQl2YXIgbUltYWdlVVJMID0g
JCgiTWVkaXVtSW1hZ2UgPiBVUkwiLHRoaXMpLnRleHQoKTsKCQl2YXIgbEltYWdlVVJMID0g
JCgiTGFyZ2VJbWFnZSA+IFVSTCIsdGhpcykudGV4dCgpOwoJCXZhciB1cmwgPSAkKCdEZXRh
aWxQYWdlVVJMJyx0aGlzKS50ZXh0KCk7CgkJdmFyIGFzaW4gPSAkKCdBU0lOJyx0aGlzKS50
ZXh0KCk7CgoKCQl2YXIgYW1hem9uSFRNTCA9ICc8YSBocmVmPSInK3VybCsnIj48aW1nIHNy
Yz0iJysgc0ltYWdlVVJMICsnIiBzdHlsZT0iZGlzcGxheTogYmxvY2s7bWFyZ2luLWxlZnQ6
IGF1dG87bWFyZ2luLXJpZ2h0OiBhdXRvOyIvPjxzcGFuIHN0eWxlPSJ0ZXh0LWFsaWduOiBj
ZW50ZXIiPicgKyB0aXRsZSArICc8L3NwYW4+PC9hPicgOwoKCQl2YXIgZm9ybSA9ICc8Zm9y
bSBpZD0iYXN2X2FtYXpvbjJfJythc2luKycgb25zdWJtaXQ9ImFzdl9hbWF6b24yX2FkZHRv
Qm9keShcJycrYXNpbisnXCcpIj4nICsKCQkJCQknPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFt
ZT0iYXN2X2FtYXpvbjJfdGl0bGUiIHZhbHVlPSInK3RpdGxlKyciIC8+JyArCgkJCQkJJzxp
bnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFzdl9hbWF6b24yX3NJbWFnZVVSTCIgdmFsdWUg
PSInK3NJbWFnZVVSTCsnIiAvPicgKwoJCQkJCSc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1l
PSJhc3ZfYW1hem9uMl9tSW1hZ2VVUkwiIHZhbHVlID0iJyttSW1hZ2VVUkwrJyIgLz4nICsK
CQkJCQknPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYXN2X2FtYXpvbjJfbEltYWdlVVJM
IiB2YWx1ZSA9IicrbEltYWdlVVJMKyciIC8+JyArCgkJCQkJJzxpbnB1dCB0eXBlPSJoaWRk
ZW4iIG5hbWU9ImFzdl9hbWF6b24yX3VybCIgdmFsdWUgPSInK3VybCsnIiAvPicgKwoJCQkJ
CSc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhc3ZfYW1hem9uMl9hc2luIiB2YWx1ZSA9
IicrYXNpbisnIiAvPicgKwoJCQkJCSc8aW5wdXQgdHlwZT0iYnV0dG9uIiBzdHlsZT0iZmxv
YXQ6cmlnaHQiIG9uY2xpY2s9ImFzdl9hbWF6b24yX2FkZHRvQm9keShcJycrYXNpbisnXCcp
IiBjbGFzcz0icHVibGlzaCIgdmFsdWU9ImFkZCIgLz4nCgkJCQkgICAnPC9mb3JtPic7CgoJ
CWxpbmUgKz0gJzxwPicgKyBmb3JtICsgYW1hem9uSFRNTCAgKyAnPC9wPic7CiAgICB9KTsK
CglsaW5lICs9IGFzdl9wcmV2bmV4dF9saW5rKGtleXdvcmRzLCBzZWFyY2hpbmRleCwgaXRl
bVBhZ2UsIHRvdGFsUGFnZXMsICJib3R0b20iKTsKCiAgICAkKCIjYXN2X2FtYXpvbjJSZXN1
bHRzRGF0YSIpLmh0bWwobGluZSk7CgkkKCIjYXN2X2FtYXpvbjJSZXN1bHRzRGF0YSIpLmNz
cygibWF4LWhlaWdodCIsICI1MDBweCIpOwoJJCgiI2Fzdl9hbWF6b24yUmVzdWx0c0RhdGEi
KS5jc3MoIm92ZXJmbG93IiwgImF1dG8iKTsKCSQoIiNhc3ZfYW1hem9uMlJlc3VsdHNEYXRh
IikuY3NzKCJwYWRkaW5nIiwgIjBweCAwcHggMTBweCAwcHgiKTsKfQoKLy8tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgok
LmZuLmFwcGVuZFZhbCA9IGZ1bmN0aW9uKHR4dCkgewogICAgcmV0dXJuIHRoaXMuZWFjaChm
dW5jdGlvbigpewogICAgICAgIHRoaXMudmFsdWUgKz0gdHh0OwogICAgfSk7Cgp9OwoKLy8t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCgpmdW5jdGlvbiBhc3ZfYW1hem9uMl9hZGR0b0JvZHkoYXNpbikKewoJdmFyIGVs
ZW0gPSAkKCcjYXN2X2FtYXpvbjJfJythc2luKTsKCgl2YXIgdGl0bGUgPSAkKCdpbnB1dDpo
aWRkZW5bQG5hbWU9YXN2X2FtYXpvbjJfdGl0bGVdJykudmFsKCk7Cgl2YXIgc0ltYWdlVVJM
ID0gJCgnaW5wdXQ6aGlkZGVuW0BuYW1lPWFzdl9hbWF6b24yX3NJbWFnZVVSTF0nKS52YWwo
KTsKCXZhciBtSW1hZ2VVUkwgPSAkKCdpbnB1dDpoaWRkZW5bQG5hbWU9YXN2X2FtYXpvbjJf
bUltYWdlVVJMXScpLnZhbCgpOwoJdmFyIGxJbWFnZVVSTCA9ICQoJ2lucHV0OmhpZGRlbltA
bmFtZT1hc3ZfYW1hem9uMl9sSW1hZ2VVUkxdJykudmFsKCk7Cgl2YXIgdXJsID0gJCgnaW5w
dXQ6aGlkZGVuW0BuYW1lPWFzdl9hbWF6b24yX3VybF0nKS52YWwoKTsKCXZhciBmb3JtID0g
JCgiI2Fzdl9hbWF6b24yX2Zvcm0gb3B0aW9uW0BzZWxlY3RlZF0iKS50ZXh0KCk7CgoJaWYo
Zm9ybSAhPSAiIikKCXsKCQkkLmdldCgnaW5kZXgucGhwJywKCQkJe2Fzdl9hbWF6b24yX2Zv
cm1fYWN0aW9uOiAiMSIsIGFzdl9hbWF6b24yX3RpdGxlOiB0aXRsZSwgYXN2X2FtYXpvbjJf
YXNpbjogYXNpbiwgYXN2X2FtYXpvbjJfc0ltYWdlVVJMOiBzSW1hZ2VVUkwsIGFzdl9hbWF6
b24yX21JbWFnZVVSTDogbUltYWdlVVJMLCBhc3ZfYW1hem9uMl9sSW1hZ2VVUkw6IGxJbWFn
ZVVSTCwgYXN2X2FtYXpvbjJfdXJsOiB1cmwsIGFzdl9hbWF6b24yX2Zvcm06IGZvcm0gfSwK
CQkgICBhc3ZfYW1hem9uMl9hZGR0b0JvZHlfUmVzcG9uc2UKCQkgKTsKCX0KCWVsc2UKCXsK
CQlhbGVydCgiSSBoYXZlbid0IGltcGxlbWVudGVkIHRoZSBjdXN0b20gYnVpbGRlciB5ZXQu
IFlvdSdsbCBoYXZlIHRvIGNyZWF0ZSBhIGZvcm0iKTsKCX0KCS8qCgkJdmFyIGltYWdlU2l6
ZTsKCQl2YXIgaW5jbHVkZVRpdGxlOwoJCXZhciBpbmNsdWRlTGluazsKCQkkLmdldCgnaW5k
ZXgucGhwJywKCQkJe2Fzdl9hbWF6b24yX2Zvcm1fYWN0aW9uOiAiMiIsIGFzdl9hbWF6b24y
X3RpdGxlOiB0aXRsZSwgYXN2X2FtYXpvbjJfYXNpbjogYXNpbiwgYXN2X2FtYXpvbjJfc0lt
YWdlVVJMOiBzSW1hZ2VVUkwsIGFzdl9hbWF6b24yX21JbWFnZVVSTDogbUltYWdlVVJMLCBh
c3ZfYW1hem9uMl9sSW1hZ2VVUkw6IGxJbWFnZVVSTCwgYXN2X2FtYXpvbjJfdXJsOiB1cmws
IGFzdl9hbWF6b24yX2Zvcm06IGZvcm0gfSwKCQkgICBhc3ZfYW1hem9uMl9hZGR0b0JvZHlf
UmVzcG9uc2UKCSovCn0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYXN2X2FtYXpvbjJfYWRkdG9C
b2R5X1Jlc3BvbnNlKHJlc3BvbnNlKQp7CgkkKCcjYm9keScpLmFwcGVuZFZhbCgnXFxuJyAr
IHJlc3BvbnNlKTsKfQoKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vQWRkIHRoZSBBbWF6b24gaW5mb3JtYXRpb24g
dG8gdGhlIGJvZHkgb2YgdGhlIGFydGljbGUKCmZ1bmN0aW9uIGFzdl9vbkNsaWNrKGVsZW0p
CnsKCSQoJyNib2R5JykuYXBwZW5kKCIgYSIpOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGFz
dl9jYW5jZWxSZXN1bHRzKCkKewoJJCgnI2Fzdl9hbWF6b24yUmVzdWx0cycpLmhpZGUoJ3Ns
b3cnKTsKCSQoJyNhc3ZfYW1hem9uMmZvcm0nKS5oaWRlKCdzbG93Jyk7Cn0KCi8vLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQoKZnVuY3Rpb24gYXN2X3ByZXZuZXh0X2xpbmsoa2V5d29yZHMsIHNlYXJjaGluZGV4LCBp
dGVtUGFnZSwgdG90YWxQYWdlcywgbG9jKQp7CglsaW5lID0gJyc7CgoJaWYocGFyc2VJbnQo
dG90YWxQYWdlcyk+MSkKCXsKCQlpZihsb2M9PSJib3R0b20iKSBsaW5lKz0nPGhyIC8+JzsK
CgkJbGluZSs9JzxwIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Ij4nOwoKCQlpdGVtUGFn
ZSA9IHBhcnNlSW50KGl0ZW1QYWdlKTsKCgkJdmFyIHRleHQgPSAnJzsKCgkJaWYoaXRlbVBh
Z2U+MSkKCQl7CgkJCXZhciBwSXRlbVBhZ2UgPSBpdGVtUGFnZSAtIDE7CgoJCQlsaW5lICs9
ICc8YSBocmVmPSIjIiBvbmNsaWNrPSJhc3ZfcmVxdWVzdChcJycra2V5d29yZHMgKyAnXCcs
XCcnICsgc2VhcmNoaW5kZXggKyAnXCcsXCcnKyBwSXRlbVBhZ2UrJ1wnKTtyZXR1cm4gZmFs
c2U7Ij5wcmV2aW91czwvYT4gfCAnOwoKCQl9CgkJaWYoaXRlbVBhZ2U8dG90YWxQYWdlcykK
CQl7CgkJCXZhciBuSXRlbVBhZ2UgPSBpdGVtUGFnZSArIDE7CgoJCQlsaW5lICs9ICc8YSBo
cmVmPSIjIiBvbmNsaWNrPSJhc3ZfcmVxdWVzdChcJycra2V5d29yZHMgKyAnXCcsXCcnICsg
c2VhcmNoaW5kZXggKyAnXCcsXCcnKyBuSXRlbVBhZ2UrJ1wnKTtyZXR1cm4gZmFsc2U7Ij5u
ZXh0PC9hPic7CgoJCX0KCgkJbGluZSs9JzwvcD4nOwoKCQlpZihsb2M9PSJ0b3AiKSBsaW5l
Kz0nPGhyIC8+JzsKCX0KCglyZXR1cm4gbGluZTsKfQoKLy8tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyAtLT4KPC9z
Y3JpcHQ+CkVPRjsKCWVjaG8gJGpzOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGFzdl9zYWZl
SlMoJGxpbmUpCnsKCXJldHVybiBzdHJfcmVwbGFjZSgiXG4iLCAiIiwgYWRkc2xhc2hlcygk
bGluZSkpOwp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNsYXNzIGFzdl9BbWF6b24KewoJdmFyICRhcGlfa2V5
ID0gIjBZOEYxWVYxTjJZU0dKMU1DMjAyIjsKCXZhciAkY29udGVudFR5cGUgPSAidGV4dCUy
RnhtbCI7Cgl2YXIgJG9wZXJhdGlvbiA9ICJJdGVtU2VhcmNoIjsKCXZhciAkc2VydmljZSA9
ICJBV1NFQ29tbWVyY2VTZXJ2aWNlIjsKCXZhciAkYmFzZVVSTCA9ICJodHRwOi8vZWNzLmFt
YXpvbmF3cy5jb20vb25jYS94bWw/IjsKCXZhciAkc2VhcmNoSW5kZXggPSAiQmxlbmRlZCI7
Cgl2YXIgJHJlc3BvbnNlR3JvdXAgPSAiSW1hZ2VzLFNtYWxsIjsKCXZhciAkdmVyc2lvbiA9
ICIyMDA1LTAzLTIzIjsKCXZhciAkbG9jYWxlOwoKCS8vLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCWZ1bmN0aW9uIGFz
dl9BbWF6b24oJGxvY2FsZSkKCXsKCQkkdGhpcy0+JGxvY2FsZSA9ICRsb2NhbGU7Cgl9CgoJ
Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCgoJZnVuY3Rpb24gcmVxdWVzdCgka2V5d29yZHMsICRzZWFyY2hpbmRleCwg
JGl0ZW1QYWdlID0gIjEiKQoJewoJCSR1cmwgPSAkdGhpcy0+YnVpbGRVUkwoZG9TbGFzaCgk
a2V5d29yZHMpLCBkb1NsYXNoKCRzZWFyY2hpbmRleCksIGRvU2xhc2goJGl0ZW1QYWdlKSk7
CgoJCS8vIGNyZWF0ZSBhIG5ldyBjdXJsIHJlc291cmNlCgkJJGNoID0gY3VybF9pbml0KCk7
CgoJCS8vIHNldCBVUkwgYW5kIG90aGVyIGFwcHJvcHJpYXRlIG9wdGlvbnMKCQljdXJsX3Nl
dG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdXJsKTsKCgkJLy8gZ3JhYiBVUkwgYW5kIHBhc3Mg
aXQgdG8gdGhlIGJyb3dzZXIKCQljdXJsX2V4ZWMoJGNoKTsKCgkJLy8gY2xvc2UgY3VybCBy
ZXNvdXJjZSwgYW5kIGZyZWUgdXAgc3lzdGVtIHJlc291cmNlcwoJCWN1cmxfY2xvc2UoJGNo
KTsKCX0KCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KCglmdW5jdGlvbiBidWlsZFVSTCAvKiBwcml2YXRlICovKCRr
ZXl3b3JkcywgJHNlYXJjaGluZGV4LCAkaXRlbVBhZ2UgPSAiMSIpCgl7CgkJJHVybCA9ICR0
aGlzLT5iYXNlVVJMLgoJCQkJIlNlcnZpY2U9Ii4kdGhpcy0+c2VydmljZS4KCQkJCSImT3Bl
cmF0aW9uPSIuJHRoaXMtPm9wZXJhdGlvbi4KCQkJCSImU3Vic2NyaXB0aW9uSWQ9Ii4kdGhp
cy0+YXBpX2tleS4KCQkJCSImU2VhcmNoSW5kZXg9Ii4kc2VhcmNoaW5kZXguCgkJCQkiJktl
eXdvcmRzPSIuJGtleXdvcmRzLgoJCQkJIiZSZXNwb25zZUdyb3VwPSIuJHRoaXMtPnJlc3Bv
bnNlR3JvdXAuCgkJCQkiJkl0ZW1QYWdlPSIuJGl0ZW1QYWdlLiImVmVyc2lvbj0iLiR0aGlz
LT52ZXJzaW9uOwoKCQlyZXR1cm4gJHVybDsKCX0KCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KfQoKLy8tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CiI7czozOiJtZDUiO3M6MzI6IjY2MzliMzU1ZGMxYmUyMTgzMmUxZGFlYzlmZGU4OTk5Ijt9
